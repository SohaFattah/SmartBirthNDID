# تدفق البيانات والعمليات في نظام الهوية الرقمية للمواليد

## نظرة عامة على النموذج الأولي

يتضمن النموذج الأولي **7 صفحات HTML** تغطي كامل رحلة المستخدم من تسجيل الدخول إلى عرض لوحة تحكم الأمان. كل صفحة تمثل خطوة من خطوات العملية.

---

## 1. خريطة الصفحات والتسلسل

```
┌─────────────────────────────────────────────────────────────────┐
│                    نظام الهوية الرقمية للمواليد                  │
│                    (Newborn Digital ID System)                   │
└─────────────────────────────────────────────────────────────────┘

┌──────────────────────┐
│  1. تسجيل الدخول      │  (index.html)
│  Login Page          │
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  2. إدخال البيانات    │  (parent-data.html)
│  Parent Data Entry   │
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  3. التقاط البصمة     │  (fingerprint-capture.html)
│  Fingerprint Capture │
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  4. ربط الأساور      │  (wristband-linking.html)
│  Wristband Linking   │
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  5. تأكيد البيانات    │  (confirmation.html)
│  Confirmation       │
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  6. الإشعار          │  (notification.html)
│  Success Notification│
└──────────┬───────────┘
           │
           ▼
┌──────────────────────┐
│  7. لوحة الأمان      │  (security-dashboard.html)
│  Security Dashboard  │
└──────────────────────┘
```

---

## 2. تدفق البيانات التفصيلي

### المرحلة 1: تسجيل الدخول (Login)

**الملف:** `index.html`

**المدخلات:**
- اسم المستخدم (رقم الموظف)
- كلمة المرور
- المستشفى

**المخرجات:**
- حفظ بيانات المستخدم في `localStorage`:
  ```javascript
  localStorage.setItem('currentUser', username);
  localStorage.setItem('currentHospital', hospital);
  ```

**الانتقال إلى:** `parent-data.html`

---

### المرحلة 2: إدخال بيانات الوالدين

**الملف:** `parent-data.html`

**المدخلات:**
- بيانات الأم (الاسم، رقم الهوية، الجوال، البريد الإلكتروني)
- بيانات الأب (الاسم، رقم الهوية، الجوال، البريد الإلكتروني)
- بيانات المولود (الاسم، الجنس، وقت الولادة، الوزن)

**المخرجات:**
- حفظ البيانات في `localStorage`:
  ```javascript
  const parentData = {
      mother: { name, id, phone, email },
      father: { name, id, phone, email },
      baby: { name, gender, birthTime, weight }
  };
  localStorage.setItem('parentData', JSON.stringify(parentData));
  ```

**التحقق:**
- التحقق من صحة الهوية الوطنية
- التحقق من صيغة البريد الإلكتروني
- التحقق من صحة أرقام الجوال

**الانتقال إلى:** `fingerprint-capture.html`

---

### المرحلة 3: التقاط البصمة البيومترية المزدوجة (الأم والمولود)

**الملف:** `fingerprint-capture.html`

**المدخلات:**
- محاكاة التقاط البصمة من جهاز محمول باليد (Handheld Biometric Scanner)
- بصمة الأم (Mother's Fingerprint)
- بصمة المولود (Baby's Fingerprint)

**العملية:**
1. **الخطوة 1 - بصمة الأم:** عند الضغط على "بدء التقاط بصمة الأم"، يبدأ شريط جودة البصمة بالزيادة تدريجيًا
2. عند الوصول إلى 100%، يتم تأكيد التقاط بصمة الأم
3. **الخطوة 2 - بصمة المولود:** يتم نفس العملية لبصمة المولود
4. **الربط المزدوج:** يتم ربط بصمة المولود ببصمة الأم في معرّف فريد (Linked Biometric ID)
5. **التوثيق الفوري:** يتم التقاط صورة فوتوغرافية فورية للمولود والأم معًا (Visual Documentation)

**المخرجات:**
- حفظ بيانات البصمة المزدوجة في `localStorage`:
  ```javascript
  const fingerprintData = {
      motherFingerprint: {
          timestamp: new Date().toISOString(),
          quality: 100,
          fingerprintID: 'FP_MOM_' + randomID
      },
      babyFingerprint: {
          timestamp: new Date().toISOString(),
          quality: 100,
          fingerprintID: 'FP_BABY_' + randomID
      },
      linkedBiometricID: 'LINKED_' + randomID,
      visualDocumentation: {
          timestamp: new Date().toISOString(),
          imageHash: 'IMG_' + randomID
      }
  };
  localStorage.setItem('fingerprintData', JSON.stringify(fingerprintData));
  ```

**الانتقال إلى:** `wristband-linking.html`

---

### المرحلة 4: ربط الأساور الذكية والمعرف الفريد

**الملف:** `wristband-linking.html`

**المدخلات:**
- ربط سوار المولود (Baby Wristband)
- ربط سوار الأم (Mother Wristband)
- ربط المعرف الفريد (Unique ID) بالسوار

**العملية:**
1. **الخطوة 1 - إنشاء السوار:** يتم طباعة السوار الذكي بمعرف فريد (Unique ID) مباشرة على طاولة الولادة
2. **الخطوة 2 - ربط المولود:** عند الضغط على "ربط سوار المولود"، يتم ربط السوار بيد المولود وتسجيل الوقت والموقع
3. **الخطوة 3 - ربط الأم:** يتم ربط سوار الأم بنفس الطريقة
4. **التحقق المزدوج:** يتم التحقق من أن المعرف الفريد (من السوار) يطابق المعرف المرتبط ببصمة الأم والمولود
5. عند ربط كلا السوارين بنجاح، يتم تفعيل زر "التالي"

**المخرجات:**
- حفظ بيانات الأساور:
  ```javascript
  const babyWristbandData = {
      id: 'WB-BABY-' + randomID,
      linkedAt: new Date().toISOString()
  };
  localStorage.setItem('babyWristbandData', JSON.stringify(babyWristbandData));

  const motherWristbandData = {
      id: 'WB-MOM-' + randomID,
      linkedAt: new Date().toISOString()
  };
  localStorage.setItem('motherWristbandData', JSON.stringify(motherWristbandData));
  ```

**الانتقال إلى:** `confirmation.html`

---

### المرحلة 5: تأكيد البيانات والإرسال

**الملف:** `confirmation.html`

**المدخلات:**
- تحميل جميع البيانات المدخلة من `localStorage`
- الموافقة على الشروط والأحكام

**العملية:**
1. عرض جميع البيانات المدخلة للمراجعة
2. يجب تحديد خانتي الموافقة لتفعيل زر الإرسال
3. عند الضغط على "إرسال البيانات"، يتم محاكاة إرسال البيانات إلى النظام الحكومي

**المخرجات:**
- حفظ بيانات الإرسال:
  ```javascript
  const submissionData = {
      timestamp: new Date().toISOString(),
      status: 'submitted',
      registrationNumber: 'REG-' + randomID
  };
  localStorage.setItem('submissionData', JSON.stringify(submissionData));
  ```

**الانتقال إلى:** `notification.html` (بعد 3 ثوان من الإرسال)

---

### المرحلة 6: إشعار النجاح

**الملف:** `notification.html`

**المدخلات:**
- تحميل بيانات الإرسال من `localStorage`
- توليد رقم هوية جديد

**المخرجات:**
- عرض:
  - رقم التسجيل
  - رقم الهوية الجديد
  - تاريخ التسجيل
  - حالة شهادة الميلاد
  - الإشعارات المرسلة
  - الخطوات التالية

**الانتقال إلى:** `security-dashboard.html`

---

### المرحلة 7: لوحة تحكم الأمان والتتبع

**الملف:** `security-dashboard.html`

**المدخلات:**
- تحميل بيانات الوالدين والمولود من `localStorage`

**المخرجات:**
- عرض:
  - حالة المولود (الاسم، رقم السوار، الحالة، الموقع، درجة الحرارة، إلخ)
  - حالة الأم (الاسم، رقم السوار، الحالة، الموقع، درجة الحرارة، إلخ)
  - خريطة التتبع في الوقت الفعلي
  - السجل الزمني للأحداث
  - محاكاة التنبيهات الأمنية

---

## 3. هيكل البيانات في localStorage

```javascript
// بيانات المستخدم الحالي
{
  currentUser: "EMP001",
  currentHospital: "KSA_CENTRAL"
}

// بيانات الوالدين والمولود
{
  parentData: {
    mother: {
      name: "فاطمة علي",
      id: "1234567890",
      phone: "0512345678",
      email: "fatima@example.com"
    },
    father: {
      name: "محمد علي",
      id: "0987654321",
      phone: "0512345679",
      email: "mohammad@example.com"
    },
    baby: {
      name: "أحمد محمد",
      gender: "male",
      birthTime: "14:30",
      weight: "3.5"
    }
  }
}

// بيانات البصمة
{
  fingerprintData: {
    timestamp: "2025-12-11T14:35:00.000Z",
    quality: 100,
    fingerprintID: "FP_ABC123DEF"
  }
}

// بيانات الأساور
{
  babyWristbandData: {
    id: "WB-BABY-XYZ789",
    linkedAt: "2025-12-11T14:40:00.000Z"
  },
  motherWristbandData: {
    id: "WB-MOM-ABC456",
    linkedAt: "2025-12-11T14:42:00.000Z"
  }
}

// بيانات الإرسال
{
  submissionData: {
    timestamp: "2025-12-11T14:50:00.000Z",
    status: "submitted",
    registrationNumber: "REG-XYZ123"
  }
}
```

---

## 4. التدفقات الجانبية والتكاملات المحاكاة

### التحقق من الهوية مع أبشر (محاكاة)
عند إدخال بيانات الوالدين، يتم التحقق من:
- وجود الهوية الوطنية في النظام
- تطابق بيانات الهوية مع البيانات المدخلة
- عدم وجود تسجيلات سابقة للمولود

### إصدار شهادة الميلاد (محاكاة)
عند تأكيد البيانات، يتم:
- توليد رقم هوية جديد
- إنشاء شهادة ميلاد رسمية
- إضافة المولود إلى سجل الأسرة

### نظام التتبع الأمني (محاكاة)
في لوحة الأمان، يتم عرض:
- موقع المولود والأم في الوقت الفعلي
- حالة الأساور الذكية
- التنبيهات الأمنية (محاكاة)
- السجل الزمني للأحداث

---

## 5. نقاط الأمان والتحقق (المحسّنة)

| المرحلة | نقاط الأمان |
| :--- | :--- |
| **تسجيل الدخول** | التحقق من بيانات الموظف والمستشفى |
| **إدخال البيانات** | التحقق من صحة الهوية والبريد الإلكتروني |
| **التقاط البصمة المزدوجة** | التحقق من جودة بصمة الأم والمولود (100%) + الربط البيومتري المزدوج + التوثيق البصري الفوري |
| **ربط الأساور** | التحقق من ربط كلا السوارين + مطابقة المعرف الفريد مع البصمات المرتبطة |
| **التأكيد** | الموافقة على الشروط والأحكام |
| **الإرسال** | تشفير البيانات وإرسالها بشكل آمن |
| **التتبع** | مراقبة الأساور والموقع في الوقت الفعلي + التحقق المستمر من مطابقة السوار مع الهوية |

---

## 6. كيفية تشغيل النموذج الأولي

1. **فتح الملف الرئيسي:**
   ```bash
   open index.html
   ```

2. **تسجيل الدخول:**
   - اسم المستخدم: `EMP001` (أو أي قيمة)
   - كلمة المرور: أي قيمة
   - المستشفى: اختر من القائمة

3. **إدخال البيانات:**
   - أدخل بيانات الوالدين والمولود

4. **التقاط البصمة:**
   - اضغط على "بدء التقاط" وانتظر اكتمال العملية

5. **ربط الأساور:**
   - اضغط على "ربط السوار" لكل سوار

6. **تأكيد البيانات:**
   - راجع البيانات وأكد الموافقة

7. **عرض النتائج:**
   - اطلع على إشعار النجاح ولوحة الأمان

---

## 7. الملفات المرفقة

| الملف | الوصف |
| :--- | :--- |
| `index.html` | صفحة تسجيل الدخول |
| `parent-data.html` | صفحة إدخال بيانات الوالدين |
| `fingerprint-capture.html` | صفحة التقاط البصمة |
| `wristband-linking.html` | صفحة ربط الأساور |
| `confirmation.html` | صفحة تأكيد البيانات |
| `notification.html` | صفحة إشعار النجاح |
| `security-dashboard.html` | لوحة تحكم الأمان |
| `DATA_FLOW.md` | هذا الملف (توثيق تدفق البيانات) |

---

## 8. ملاحظات مهمة

- **هذا نموذج أولي:** جميع البيانات محفوظة في `localStorage` ولا يتم إرسالها فعليًا إلى خادم.
- **المحاكاة:** جميع العمليات (البصمة، الأساور، الإرسال) محاكاة لأغراض العرض التوضيحي.
- **الابتكار الجديد:** تم دمج **الربط البيومتري المزدوج (بصمة الأم والمولود)** و**التوثيق البصري الفوري** لضمان **سلسلة حضانة رقمية كاملة** وإغلاق جميع ثغرات التبديل.
- **التطوير المستقبلي:** يمكن استبدال المحاكاة بتكاملات حقيقية مع الأجهزة والأنظمة الحكومية.

---

## 9. الابتكار الأساسي: سلسلة الحضانة الرقمية الكاملة

**المشكلة المحلولة:** كيف نضمن أن الطفل الذي التقطنا بصمته هو نفس الطفل المولود؟

**الحل المبتكر:**
1. **الربط البيومتري المزدوج:** ربط بصمة المولود ببصمة الأم مباشرة في اللحظة الأولى (على طاولة الولادة).
2. **التوثيق البصري الفوري:** التقاط صورة فوتوغرافية فورية للمولود والأم معًا مع وقت وتاريخ دقيقين.
3. **المعرف الفريد:** طباعة سوار ذكي بمعرف فريد يتم ربطه بالمولود مباشرةً.
4. **التحقق المستمر:** مراقبة السوار والموقع في الوقت الفعلي لضمان عدم التبديل أثناء الإقامة في المستشفى.

**النتيجة:** **سلسلة حضانة رقمية كاملة وغير قابلة للتزوير** من لحظة الولادة إلى إصدار الهوية الرقمية.

---

**تم إعداد هذا النموذج الأولي لأغراض هاكاثون أبشر.**
